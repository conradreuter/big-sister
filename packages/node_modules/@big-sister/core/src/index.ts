import loadConfiguration from './loadConfiguration'
import createExtensions from './createExtensions'
import createSpy from './createSpy'
import { Observable } from 'rxjs/Observable';

start()

async function start() {
  const configuration = loadConfiguration()
  const extensions = await createExtensions(configuration.extensions)
  const spy = await createSpy(configuration.spy)
  const presence$ = extensions.reduce((p$, e) => e.transformPresence(p$), spy.presence$)
  presence$.subscribe(presence => console.log(presence))
}
