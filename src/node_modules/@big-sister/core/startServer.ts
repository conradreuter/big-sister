import { Configuration, Extension, Store } from '@big-sister'
import * as Koa from 'koa'
import * as graphql from 'koa-graphql'
import * as mount from 'koa-mount'
import schema from './schema'
import log from './utility/logging'

export default function startServer(
  configuration: Configuration['server'],
  store: Store,
  extensions: Extension[],
): void {
  const app = new Koa()
  app.use(mount(graphql({
    graphiql: configuration.graphiql,
    schema,
  })))
  app.listen(configuration.port, configuration.hostname)
  log.info(`Server started (${configuration.hostname}:${configuration.port})`)
}
